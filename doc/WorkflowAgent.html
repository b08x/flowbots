<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class WorkflowAgent - flowbots v0.1</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
<div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  <p class="link"><a href="Object.html">Object</a>
</div>

    
    
    
<!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    <li ><a href="#method-c-new">::new</a>
    <li ><a href="#method-i-load_state">#load_state</a>
    <li ><a href="#method-i-process">#process</a>
    <li ><a href="#method-i-save_state">#save_state</a>
    <li ><a href="#method-i-update_state">#update_state</a>
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-WorkflowAgent">
  <h1 id="class-WorkflowAgent" class="class">
    class WorkflowAgent
  </h1>

  <section class="description">
    
<p>This class represents an agent in a workflow. Class representing an individual agent within a workflow in the <a href="Flowbots.html"><code>Flowbots</code></a> system.</p>

<p>The <a href="WorkflowAgent.html"><code>WorkflowAgent</code></a> is a key component in the text processing pipeline, responsible for performing specific tasks as defined by its role and cartridge configuration. It’s designed to be flexible, maintainable, and integrated seamlessly with the <a href="WorkflowOrchestrator.html"><code>WorkflowOrchestrator</code></a>.</p>

<p>== Key Features</p>
<ul><li>
<p>Role-based processing: Each agent has a specific role in the workflow.</p>
</li><li>
<p><a href="Cartridge.html"><code>Cartridge</code></a>-based configuration: <a href="Agent.html"><code>Agent</code></a> behavior is defined by a cartridge file.</p>
</li><li>
<p>State management: Agents can save and load state from Redis.</p>
</li><li>
<p>Real-time feedback: Provides visual feedback during processing.</p>
</li><li>
<p><a href="Logging.html"><code>Logging</code></a>: Includes logging for monitoring and debugging.</p>
</li></ul>

<p>== Relation to Workflow</p>

<p><a href="WorkflowAgent.html"><code>WorkflowAgent</code></a> instances are typically: 1. Created and managed by the <a href="WorkflowOrchestrator.html"><code>WorkflowOrchestrator</code></a>. 2. Arranged in a sequence to form the text processing pipeline. 3. Called upon by the orchestrator to <a href="WorkflowAgent.html#method-i-process"><code>process</code></a> input and produce output. 4. Capable of maintaining state across multiple workflow steps or runs.</p>

<p>== Example Usage</p>

<p><code>ruby  agent = WorkflowAgent.new(&quot;preprocessor&quot;, &quot;path/to/cartridge.yml&quot;)  result = agent.process(input_text)  agent.save_state </code></p>

<p>== Integration</p>

<p>The <a href="WorkflowOrchestrator.html"><code>WorkflowOrchestrator</code></a> would typically: * Initialize multiple WorkflowAgents for different stages of processing. * Call the #process method of each agent in sequence. * Manage the flow of data between agents in the workflow.</p>

  </section>

  <section id="5Buntitled-5D" class="documentation-section">


    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
        <dt id="CARTRIDGE_DIR">CARTRIDGE_DIR
        <dd><p>The base directory for cartridges.</p>
      </dl>
    </section>



     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

      <div id="method-c-new" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(role, cartridge_file)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Initializes a <a href="WorkflowAgent.html#method-c-new"><code>new</code></a> <a href="WorkflowAgent.html"><code>WorkflowAgent</code></a> instance.</p>

<p>@param role [String] The role of the agent. @param cartridge_file [String] The path to the cartridge file.</p>

<p>@return [void]</p>

          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/components/WorkflowAgent.rb, line 52</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">role</span>, <span class="ruby-identifier">cartridge_file</span>)
  <span class="ruby-ivar">@role</span> = <span class="ruby-identifier">role</span>
  <span class="ruby-ivar">@state</span> = {}
  <span class="ruby-ivar">@bot</span> = <span class="ruby-constant">NanoBot</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">cartridge:</span> <span class="ruby-identifier">cartridge_file</span>
  )
  <span class="ruby-constant">UI</span>.<span class="ruby-identifier">info</span> <span class="ruby-node">&quot;Initialized WorkflowAgent with role: #{role}, cartridge: #{cartridge_file}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

      <div id="method-i-load_state" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">load_state</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Loads the agent’s state from Redis.</p>

<p>@return [void]</p>

          <div class="method-source-code" id="load_state-source">
            <pre><span class="ruby-comment"># File lib/components/WorkflowAgent.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_state</span>
  <span class="ruby-identifier">state_json</span> = <span class="ruby-constant">Jongleur</span><span class="ruby-operator">::</span><span class="ruby-constant">WorkerTask</span>.<span class="ruby-identifier">class_variable_get</span>(<span class="ruby-value">:@@redis</span>).<span class="ruby-identifier">hget</span>(
    <span class="ruby-constant">Process</span>.<span class="ruby-identifier">pid</span>.<span class="ruby-identifier">to_s</span>,
    <span class="ruby-node">&quot;agent:#{@role}&quot;</span>
  )
  <span class="ruby-ivar">@state</span> = <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">state_json</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">state_json</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-process" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">process</span><span
              class="method-args">(input)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Processes the given input using the agent’s cartridge.</p>

<p>@param input [String] The input to <a href="WorkflowAgent.html#method-i-process"><code>process</code></a>.</p>

<p>@return [String] The agent’s response.</p>

          <div class="method-source-code" id="process-source">
            <pre><span class="ruby-comment"># File lib/components/WorkflowAgent.rb, line 66</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">process</span>(<span class="ruby-identifier">input</span>)
  <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Processing input for #{@role}: #{input}&quot;</span>

  <span class="ruby-identifier">pastel</span> = <span class="ruby-constant">Pastel</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-constant">UI</span><span class="ruby-operator">::</span><span class="ruby-constant">Box</span>.<span class="ruby-identifier">eval_result_box</span>(
    <span class="ruby-ivar">@bot</span>.<span class="ruby-identifier">eval</span>(<span class="ruby-identifier">input</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">content</span>, <span class="ruby-identifier">fragment</span>, <span class="ruby-identifier">finished</span>, <span class="ruby-identifier">meta</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@response</span> = <span class="ruby-identifier">content</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">content</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">pastel</span>.<span class="ruby-identifier">blue</span>(<span class="ruby-identifier">fragment</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">fragment</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">sleep</span> <span class="ruby-value">0.025</span>
    <span class="ruby-keyword">end</span>
  )

  <span class="ruby-identifier">sleep</span>(<span class="ruby-value">2</span>)

  <span class="ruby-comment"># UI.info(@response)</span>
  <span class="ruby-identifier">update_state</span>(<span class="ruby-ivar">@response</span>)
  <span class="ruby-ivar">@response</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-save_state" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">save_state</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Saves the agent’s state to Redis.</p>

<p>@return [void]</p>

          <div class="method-source-code" id="save_state-source">
            <pre><span class="ruby-comment"># File lib/components/WorkflowAgent.rb, line 88</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">save_state</span>
  <span class="ruby-constant">Jongleur</span><span class="ruby-operator">::</span><span class="ruby-constant">WorkerTask</span>.<span class="ruby-identifier">class_variable_get</span>(<span class="ruby-value">:@@redis</span>).<span class="ruby-identifier">hset</span>(
    <span class="ruby-constant">Process</span>.<span class="ruby-identifier">pid</span>.<span class="ruby-identifier">to_s</span>,
    <span class="ruby-node">&quot;agent:#{@role}&quot;</span>,
    <span class="ruby-ivar">@state</span>.<span class="ruby-identifier">to_json</span>
  )
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

      <div id="method-i-update_state" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">update_state</span><span
              class="method-args">(response)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Updates the agent’s state with the latest response.</p>

<p>@param response [String] The agent’s response.</p>

<p>@return [void]</p>

          <div class="method-source-code" id="update_state-source">
            <pre><span class="ruby-comment"># File lib/components/WorkflowAgent.rb, line 114</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_state</span>(<span class="ruby-identifier">response</span>)
  <span class="ruby-ivar">@state</span>[<span class="ruby-value">:last_response</span>] = <span class="ruby-identifier">response</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.6.3.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

